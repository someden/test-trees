(this.webpackJsonptree=this.webpackJsonptree||[]).push([[0],{10:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),s=n(4),l=n.n(s);n(3);function o(){let e=1;const t=(n=4,c=`${e}`)=>{const a=Array.from({length:n}).map((()=>[""+ ++e,{id:`${e}`,parentId:c,value:`Node${e}`,deleted:!1}]));return n-1?a.concat(...a.map((([e])=>t(n-1,`${e}`)))):a};return[[`${e}`,{id:`${e}`,parentId:null,value:`Node${e}`,deleted:!1}],...t()]}let r=new Map(o()),d=()=>{};function u(){r.forEach((e=>{!e.deleted&&i(e.parentId)&&(e.deleted=!0)}))}function i(e){const t=r.get(e||"");return!!t&&(t.deleted||i(t.parentId))}const b={connect:function(e){d=()=>e(Array.from(r.values())),d()},reset:function(){r=new Map(o()),d()}};function j(e){if(Math.random()<.1)throw new Error(e)}const p={getLeafById:function(e){return j("Error on Load. Try again."),{...r.get(e)}},updateLeafs:function(e){j("Error on Save. Try again.");const t={},n=e.map((e=>{const n={...e};if(!r.has(n.id)){const e=`${r.size+1}`;t[n.id]=e,n.id=e}return n.parentId&&t[n.parentId]&&(n.parentId=t[n.parentId]),r.set(n.id,n),n}));return u(),d(),n}};var O=n(0);function h({id:e,parentId:t,value:n,deleted:a,children:s,actions:l}){const o=Object(c.useMemo)((()=>l({id:e,parentId:t,value:n,deleted:a})),[e,t,n,a,l]);return Object(O.jsxs)("li",{className:"list-group-item",children:[Object(O.jsxs)("div",{className:"row",children:[Object(O.jsx)("div",{className:"col align-self-center lh-lg",children:a?Object(O.jsx)("del",{className:"text-muted",children:n}):n}),a?null:Object(O.jsx)("div",{className:"col-auto align-self-center",children:Object(O.jsx)("div",{className:"btn-group btn-group-sm",children:o})})]}),s.length?Object(O.jsx)(m,{tree:s,actions:l}):null]})}function m({tree:e,actions:t}){return Object(O.jsx)("ul",{className:"list-group list-group-flush h-100 overflow-auto",children:e.map((e=>Object(O.jsx)(h,{...e,actions:t},e.id)))})}function f({leaf:e,onAdd:t,onEdit:n,onDelete:a}){const s=Object(c.useCallback)((()=>{t(e)}),[e,t]),l=Object(c.useCallback)((()=>{n(e)}),[e,n]),o=Object(c.useCallback)((()=>{a(e.id)}),[e,a]);return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("button",{type:"button",className:"btn btn-light",onClick:s,children:"Add"}),Object(O.jsx)("button",{type:"button",className:"btn btn-light",onClick:l,children:"Edit"}),Object(O.jsx)("button",{type:"button",className:"btn btn-light",onClick:o,children:"Delete"})]})}function x({tree:e,onAdd:t,onEdit:n,onDelete:a}){const s=Object(c.useCallback)((e=>Object(O.jsx)(f,{leaf:e,onAdd:t,onEdit:n,onDelete:a})),[t,n,a]);return Object(O.jsx)(m,{tree:e,actions:s})}function v({tree:e,onAdd:t,onEdit:n,onDelete:a,onApply:s,onReset:l}){const[o,r]=Object(c.useState)(null),[d,u]=Object(c.useState)(null),i=Object(c.useRef)(null),[b,j]=Object(c.useState)(""),p=Object(c.useCallback)((()=>{r(null),u(null),j("")}),[r,u,j]),h=Object(c.useCallback)((e=>{p(),r(e),setTimeout((()=>{var e;null===(e=i.current)||void 0===e||e.focus()}),0)}),[p,r]),m=Object(c.useCallback)((e=>{p(),u(e),j(e.value),setTimeout((()=>{var e;null===(e=i.current)||void 0===e||e.focus()}),0)}),[p,u,j]),f=Object(c.useCallback)((e=>{a(e),p()}),[p,a]),v=Object(c.useCallback)((e=>{j(e.target.value)}),[]),g=Object(c.useCallback)((e=>{e.preventDefault(),o&&t({id:`temp${Math.random()}${Date.now()}`,parentId:o.id,value:b,deleted:!1}),d&&n({...d,value:b}),p()}),[o,d,b,p,t,n]),C=Object(c.useCallback)((()=>{p(),s()}),[p,s]),k=Object(c.useCallback)((()=>{p(),l()}),[p,l]);return Object(O.jsxs)("div",{className:"card h-100 d-flex flex-column",children:[Object(O.jsx)(x,{tree:e,onAdd:h,onEdit:m,onDelete:f}),Object(O.jsx)("div",{className:"card-body",children:Object(O.jsxs)("div",{className:"btn-toolbar flex-nowrap",children:[Object(O.jsxs)("form",{onSubmit:g,className:"input-group input-group-sm me-4 flex-nowrap w-100",children:[Object(O.jsx)("input",{ref:i,type:"text",className:"form-control",value:b,onChange:v,disabled:!o&&!d}),o?Object(O.jsxs)("span",{className:"input-group-text",children:["Parent: ",o.value]}):null,Object(O.jsx)("button",{type:"submit",className:"btn btn-outline-success",disabled:!o&&!d,children:"Ok"})]}),Object(O.jsx)("div",{className:"btn-group btn-group-sm me-2",children:Object(O.jsx)("button",{type:"button",className:"btn btn-outline-success",onClick:C,children:"Apply"})}),Object(O.jsx)("div",{className:"btn-group btn-group-sm",children:Object(O.jsx)("button",{type:"button",className:"btn btn-outline-danger",onClick:k,children:"Reset"})})]})})]})}function g(e){const t=[],n=e.reduce(((e,t)=>({...e,[t.id]:{...t,children:[]}})),{});return e.forEach((e=>{e.parentId&&n[e.parentId]?n[e.parentId].children.push(n[e.id]):t.push(n[e.id])})),t}function C(e){const t=e.reduce(((e,t)=>({...e,[t.id]:t})),{});return e.map((e=>!e.deleted&&k(t,e.parentId)?{...e,deleted:!0}:e))}function k(e,t){const n=t&&e[t];return!!n&&(n.deleted||k(e,n.parentId))}function N({leaf:e,onLoadToCache:t}){const n=Object(c.useCallback)((()=>{t(e.id)}),[e,t]);return Object(O.jsx)("button",{type:"button",className:"btn btn-light",onClick:n,children:"Load"})}function y({onLoadToCache:e}){const[t,n]=Object(c.useState)([]);Object(c.useEffect)((()=>{b.connect(n)}),[n]);const a=Object(c.useCallback)((t=>Object(O.jsx)(N,{leaf:t,onLoadToCache:e})),[e]),s=Object(c.useMemo)((()=>g(t)),[t]);return Object(O.jsx)("div",{className:"card h-100 overflow-auto",children:Object(O.jsx)(m,{tree:s,actions:a})})}function I(){const[e,t,n,a,s]=function(){const[e,t]=Object(c.useState)([]);return[e,Object(c.useCallback)((e=>{t((t=>t.some((({id:t})=>t===e.id))?t:C([...t,e])))}),[t]),Object(c.useCallback)((e=>{t((t=>t.map((t=>t.id===e.id?{...t,...e}:t))))}),[t]),Object(c.useCallback)((e=>{t((t=>C(t.map((t=>t.id===e?{...t,deleted:!0}:t)))))}),[t]),t]}(),l=Object(c.useCallback)((()=>{try{const t=p.updateLeafs(e);s(t)}catch(t){alert(t.message)}}),[e,s]),o=Object(c.useCallback)((()=>{s([]),b.reset()}),[s]),r=Object(c.useCallback)((e=>{try{const n=p.getLeafById(e);t(n)}catch(n){alert(n.message)}}),[t]),d=Object(c.useMemo)((()=>g(e)),[e]);return Object(O.jsx)("div",{className:"app container py-5",children:Object(O.jsxs)("div",{className:"row h-100",children:[Object(O.jsx)("div",{className:"col h-100",children:Object(O.jsx)(v,{tree:d,onAdd:t,onEdit:n,onDelete:a,onApply:l,onReset:o})}),Object(O.jsx)("div",{className:"col h-100",children:Object(O.jsx)(y,{onLoadToCache:r})})]})})}l.a.render(Object(O.jsx)(a.a.StrictMode,{children:Object(O.jsx)(I,{})}),document.getElementById("root"))},3:function(e,t,n){}},[[10,1,2]]]);
//# sourceMappingURL=main.b9f1a4ce.chunk.js.map